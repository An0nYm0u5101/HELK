# HELK winevent-security output conf file
# HELK build Stage: Alpha
# Author: Lee Christensen (@tifkin_)
# License: GPL-3.0

output {
  if [log_name]=~ /^[mM]icrosoft\-[wW]indows\-(wmi|WMI)\-[aA]ctivity\/[oO]perational$/ and [@metadata][helk_parsed] == "yes" {
    kafka {
      bootstrap_servers => "helk-kafka-broker:9092"
      codec => "json"
      topic_id => "parsed_winevent"
    }
    #if "[@metadata][enable_es]" == "true" {
    #  elasticsearch {
    #    hosts => ["${ES_HOST:helk-elasticsearch}:${ES_PORT:9200}"]
    #    index => "logs-endpoint-winevent-wmiactivity-%{+YYYY.MM.dd}"
    #    document_id => "%{[@metadata][log_hash]}"
    #    user => 'elastic'
    #    #password => 'elasticpassword'
    #  }
    #}
  }
}