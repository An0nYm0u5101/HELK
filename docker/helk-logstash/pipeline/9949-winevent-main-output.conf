# HELK winevent-main output conf file
# HELK build Stage: Alpha
# Author: Roberto Rodriguez (@Cyb3rWard0g)
# License: GPL-3.0

output {
  if [@metadata][index_name] and [event_id] and [@metadata][helk_parsed] == "yes" {
    kafka {
      bootstrap_servers => "helk-kafka-broker:9092"
      codec => "json"
      topic_id => "parsed_winevent"
    }
    if "[@metadata][enable_es]" == "true" {
      elasticsearch {
        hosts => ["${ES_HOST}:${ES_PORT}"]
        index => "logs-endpoint-winevent-%{[@metadata][index_name]}-%{+YYYY.MM.dd}"
        document_id => "%{[@metadata][log_hash]}"
        user => 'elastic'
        #password => 'elasticpassword'
      }
    }
  }
}